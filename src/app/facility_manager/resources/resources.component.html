<div *ngIf="isLoaded==false" class="loader"></div>

<div *ngIf="isLoaded" class="animated fadeIn" ng-app style="width: 100%">

  <div>
    <!--/.col-->

    <div class="card" style="width: 100%;">
      <div class="card-header">

          <i class="fa fa-align-justify"></i> Resources
          <div >

            <button style="margin: 5px"
                    class="btn"
                    [ngClass]="(PUBLIC_ACTIVE) ? 'btn-primary': 'btn-outline-primary'"

                    (click)="setResources(PUBLIC_RESOURCES)">Public Resources
            </button>

            <button style="margin: 5px"
                    [ngClass]="(INTERN_ACTIVE) ? 'btn-primary': 'btn-outline-primary'"
                    class="btn"
                    (click)="setResources(INTERN_RESOURCES);">Intern Resources
            </button>
            <button style="margin: 5px"
                    [ngClass]="(ALL_RESOURCES) ? 'btn-primary': 'btn-outline-primary'"
                    class="btn"
                    (click)="setResources(ALL_RESOURCES)">All Resources
            </button>


            <button style="float:right;margin: 5px;" class="btn btn-outline-primary" (click)="factorModal.show()">Modify
              Limits
            </button>
          </div>



        <div><select [(ngModel)]="selectedFacility"
                     (ngModelChange)="isLoaded=false;onChangeSelectedFacility($event);"
                     class="form-control" name="selectedFacility">
          <option *ngFor="  let facility of managerFacilities" [ngValue]="facility">
            {{facility['Facility']}}
          </option>

        </select></div>

        <div class="card-body" style="width: 100%" id="contentToConvert">


          <div class="table-responsive">
            <table class="table table-striped table-bordered"
                   style="width: 100%">
              <thead>
              <tr>
                <th>{{today | date:'dd-MM-yyyy'}}</th>

                <th *ngFor="let r of visible_resources">{{r.resource_name}}</th>
              </tr>
              </thead>
              <tbody>

              <tr>
                <th>Ram [GB]</th>

                <td *ngFor="let r of visible_resources">
                  <span
                    *ngIf="!(r.totalRamGeneralPurpose || r.totalRamMidClass || r.totalRamHighMemory)">{{r.totalRam}}</span>
                  <table *ngIf="r.totalRamGeneralPurpose || r.totalRamMidClass || r.totalRamHighMemory">
                    <tr>
                      <th>Total</th>
                      <th>{{r.totalRam}}</th>

                    </tr>
                    <tr>
                      <td>General Purpose<br></td>
                      <td>{{r.totalRamGeneralPurpose}}</td>

                    </tr>
                    <tr>
                      <td>Mid Class<br></td>
                      <td>{{r.totalRamMidClass}}</td>

                    </tr>
                    <tr>
                      <td>High Memory<br></td>
                      <td>{{r.totalRamHighMemory}}</td>

                    </tr>
                  </table>


                </td>
              </tr>
              <tr>
                <th>Cores</th>
                <td *ngFor="let r of visible_resources">
                  <span
                    *ngIf="!(r.totalCoresGeneralPurpose || r.totalCoresMidClass || r.totalCoresHighMemory)">{{r.totalCores}}</span>
                  <table *ngIf="r.totalCoresGeneralPurpose || r.totalCoresMidClass || r.totalCoresHighMemory">
                    <tr>
                      <th>Total</th>
                      <th>{{r.totalCores}}</th>

                    </tr>
                    <tr>
                      <td>General Purpose<br></td>
                      <td>{{r.totalCoresGeneralPurpose}}</td>

                    </tr>
                    <tr>
                      <td>Mid Class<br></td>
                      <td>{{r.totalCoresMidClass}}</td>

                    </tr>
                    <tr>
                      <td>High Memory<br></td>
                      <td>{{r.totalCoresHighMemory}}</td>

                    </tr>
                  </table>


                </td>

              </tr>
              <tr>
                <th>Vms</th>
                <td *ngFor="let r of visible_resources">{{r.totalVms}}</td>
              </tr>
              <tr>
                <th>Volumes</th>
                <td *ngFor="let r of visible_resources">{{r.totalVolumeCounter}}</td>

              </tr>
            <tr>
              <th>Volumes Storage [GB]</th>
              <td *ngFor="let r of visible_resources">{{r.totalVolumeLimit}}</td>

            </tr>
            <tr>
              <th>Object Storage [GB]</th>
              <td *ngFor="let r of visible_resources">{{r.totalObjectStorage}}</td>

            </tr>
            <tr>
              <th>GPU</th>
              <td *ngFor="let r of visible_resources">{{r.totalGPU}}</td>

            </tr>
            </tbody>
          </table>

        </div>
      </div>
      <div>
        <button (click)="tableToPDF()">Download PDF</button>
        <button (click)="tableToCSV()">Download CSV</button>
      </div>            <!-- DivTable.com -->
    </div>
    <!--/.col-->
  </div>
</div>


<div bsModal #factorModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
     aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-info modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Resources Factors</h4>
        <button type="button" class="close" style="cursor: pointer"
                (click)="factorModal.hide()"
                aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="nav-tabs-boxed">
          <ul class="nav nav-tabs " style="overflow-x:visible !important">
            <li class="nav-item"><a class="nav-link" id="ram_tab" [ngClass]="{'active': RAM_TAB_ACTIVE}"
                                    (click)="setTab(RAM_TAB)">Ram</a>
            </li>
            <li class="nav-item"><a class="nav-link" d="cores_tab" [ngClass]="{'active': CORE_TAB_ACTIVE}"
                                    (click)="setTab(CORE_TAB)">Cores</a></li>
            <li class="nav-item"><a class="nav-link" id="gpu_tab" [ngClass]="{'active': GPU_TAB_ACTIVE}"
                                    (click)="setTab(GPU_TAB)"
            >GPU</a></li>

            <li class="nav-item"><a class="nav-link" id="object_storage_tab"
                                    [ngClass]="{'active': OBJECT_STORAGE_TAB_ACTIVE}"
                                    (click)="setTab(OBJECT_STORAGE_TAB)">Object Storage</a></li>
            <li class="nav-item"><a class="nav-link" id="volume_storage_tab"
                                    [ngClass]="{'active': VOLUME_STORAGE_TAB_ACTIVE}"
                                    (click)="setTab(VOLUME_STORAGE_TAB)">Volume Storage</a></li>


          </ul>


        </div>

        <div class="tab-content">
          <div *ngIf="RAM_TAB_ACTIVE && selectedFacility">
            <app-ramfactor-overview
              (factorChanged)="getSelectedFacilityResources()"
              [facility_id]="selectedFacility['FacilityId']"></app-ramfactor-overview>
          </div>
          <div *ngIf="CORE_TAB_ACTIVE && selectedFacility">
            <app-corefactor-overview
              (factorChanged)="getSelectedFacilityResources()"

              [facility_id]="selectedFacility['FacilityId']"></app-corefactor-overview>
          </div>
          <div *ngIf="OBJECT_STORAGE_TAB_ACTIVE && selectedFacility">
            <app-objectstoragefactor-overview
              (factorChanged)="getSelectedFacilityResources()"

              [facility_id]="selectedFacility['FacilityId']"></app-objectstoragefactor-overview>
          </div>
          <div *ngIf="VOLUME_STORAGE_TAB_ACTIVE && selectedFacility">
            <app-volumestoragefactor-overview
              (factorChanged)="getSelectedFacilityResources()"
              [facility_id]="selectedFacility['FacilityId']"></app-volumestoragefactor-overview>
          </div>
          <div *ngIf="GPU_TAB_ACTIVE && selectedFacility">
            <app-gpufactor-overview
              (factorChanged)="getSelectedFacilityResources()"

              [facility_id]="selectedFacility['FacilityId']"></app-gpufactor-overview>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary"
                  (click)="factorModal.hide()">
            Close
          </button>
        </div>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div>










