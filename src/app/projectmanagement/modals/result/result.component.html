@if (submit) {
	<div class="modal-header">
		<h4 class="modal-title">{{ project?.project_application_shortname }}</h4>
		<button
			type="button"
			class="btn-close"
			style="cursor: pointer"
			(click)="bsModalRef.hide()"
			data-dismiss="modal"
			aria-label="Close"
		></button>
	</div>
	<div class="modal-body">
		<div class="alert alert-primary">
			<strong> Please check the data you have entered and confirm your application below. </strong>
			<br />
			If the entered data mismatches with your requirements cancel this confirmation and take changes.
		</div>
		@if (adjustedModification) {
			<div class="alert alert-info">
				<strong>
					Please consider: These are the values of the modification request if you confirm the adjustment
				</strong>
			</div>
		}
		<div class="table-responsive">
			<table class="table table-striped">
				<tbody>
					@if (modificationExtension && !adjustedModification) {
						@for (flav of extension.flavors; track flav) {
							<tr>
								<td>{{ flav.name + ': ' + flav.counter + ' VMs' }}</td>
							</tr>
						}
						@if (extension.volume_counter > 0) {
							<tr>
								<td>Number of storage volumes: {{ extension.volume_counter }}</td>
							</tr>
						}
						@if (extension.volume_counter > 0 && extension.volume_limit > 0) {
							<tr>
								<td>Amount of storage space: {{ extension.volume_limit }} GBs</td>
							</tr>
						}
						@if (project.project_application_openstack_project && extension.object_storage > 0) {
							<tr>
								<td>Amount of object storage: {{ extension.object_storage }} GB</td>
							</tr>
						}
					}
					@if (adjustedModification) {
						@if (adjustedModification.manager_comment) {
							<tr>
								<td>VO Comment: {{ adjustedModification.manager_comment }}</td>
							</tr>
						}
						@for (flav of adjustedModification.flavors; track flav) {
							<tr>
								<td>
									<strong>{{ flav.name + ': ' + flav.counter + ' VMs' }}</strong>
								</td>
							</tr>
						}
						@if (adjustedModification.volume_counter > 0) {
							<tr>
								<td>Number of storage volumes: {{ adjustedModification.volume_counter }}</td>
							</tr>
						}
						@if (adjustedModification.volume_counter > 0 && adjustedModification.volume_limit > 0) {
							<tr>
								<td>Amount of storage space: {{ adjustedModification.volume_limit }} GBs</td>
							</tr>
						}
						@if (project.project_application_openstack_project && adjustedModification.object_storage > 0) {
							<tr>
								<td>Amount of object storage: {{ adjustedModification.object_storage }} GB</td>
							</tr>
						}
					}
					@if (selected_ontology_terms?.length > 0) {
						<tr>
							<td>
								Selected Terms:
								@for (term of selected_ontology_terms; track term) {
									<span class="badge bg-info">{{ term.term }}</span>
								}
							</td>
						</tr>
					}
					@if ((modificationExtension || lifetimeExtension || creditsExtension) && extension.comment?.length > 0) {
						<tr>
							<td>Comment : {{ extension.comment }}</td>
						</tr>
					}
					@if (modificationExtension && !adjustedModification) {
						<tr>
							<td>
								<strong>Number of cores in total: {{ extension?.total_cores }}</strong>
							</td>
						</tr>
						<tr>
							<td>
								<strong>Value of RAM in total: {{ extension?.total_ram }} GBs</strong>
							</td>
						</tr>
						<tr>
							<td>
								<strong>Number of GPUs in total: {{ extension?.total_gpu }}</strong>
							</td>
						</tr>
					}
					@if (adjustedModification) {
						<tr>
							<td>
								<strong>Number of cores in total: {{ adjustedModification?.total_cores }}</strong>
							</td>
						</tr>
						<tr>
							<td>
								<strong
									>Value of RAM in total:
									{{ adjustedModification?.total_ram }}
									GBs</strong
								>
							</td>
						</tr>
						<tr>
							<td>
								<strong>Number of GPUs in total: {{ adjustedModification?.total_gpu }}</strong>
							</td>
						</tr>
					}
					@if (lifetimeExtension) {
						<tr>
							<td>
								<strong>Additional lifetime in months: {{ extension?.extra_lifetime }}</strong>
							</td>
						</tr>
					}
					@if (creditsExtension) {
						<tr>
							<td>Amount of requested extra credits: {{ extension?.extra_credits }}</td>
						</tr>
					}
					@if (project?.credits_allowed && !creditsExtension) {
						<tr>
							@if (modificationExtension || lifetimeExtension) {
								<td>
									<strong>Approximate number of extra credits:{{ extension?.extra_credits }}</strong>
									<br />
									<strong>Approximate number of total credits:{{ expectedTotalCredits }}</strong>
									<br />
									@if (modificationExtension) {
										<alert type="info">
											Please note, that the approximate credits amounts shown here are calculated for the currently
											approved remaining lifetime of this project. This amount will be calculated anew at extension
											approval and may therefore vary.
										</alert>
									}
									@if (lifetimeExtension) {
										<alert type="info">
											Please note, that the approximate credits amounts shown here are calculated for the currently
											approved resource configuration of this project. This amount will be calculated anew at extension
											approval and may therefore vary.
										</alert>
									}
								</td>
							}
						</tr>
					}
				</tbody>
			</table>
		</div>
	</div>
	<div class="modal-footer">
		@if (lifetimeExtension && !adjustedModification) {
			<button
				id="confirm_extension_btn"
				class="btn btn-success col-md-3"
				type="button"
				data-test-id="confirm_extension_request_button"
				(click)="submitLifetimeExtensionRequest()"
			>
				Confirm
			</button>
		}
		@if (modificationExtension && !adjustedModification) {
			<button
				id="confirm_modification_btn"
				class="btn btn-success col-md-3"
				type="button"
				data-test-id="confirm_modification_request_button"
				(click)="submitModificationRequest()"
			>
				Confirm
			</button>
		}
		@if (creditsExtension && !adjustedModification) {
			<button
				id="confirm_credits_btn"
				class="btn btn-success col-md-3"
				type="button"
				data-test-id="confirm_credits_request_button"
				(click)="submitCreditsModification()"
			>
				Confirm
			</button>
		}
		@if (adjustedModification) {
			<button
				id="confirm_adjustment_btn"
				class="btn btn-success col-md-3"
				type="button"
				data-test-id="confirm_adjustment_request_button"
				(click)="submitModificationAdjustment()"
			>
				Confirm
			</button>
		}
		@if (modificationExtension) {
			<button class="btn btn-primary col-md-3" type="reset" (click)="bsModalRef.hide(); chainDataInput()">
				<i class="fa-solid fa-backward"></i> Back
			</button>
		}
		<button class="btn btn-danger col-md-3" type="reset" (click)="bsModalRef.hide()">Cancel</button>
	</div>
}

@if (result) {
	<div class="modal-header">
		@if (extensionStatus === 0) {
			<h4 class="modal-title">Waiting</h4>
		}
		@if (extensionStatus === 1) {
			<h4 class="modal-title">Success</h4>
		}
		@if (extensionStatus === 2) {
			<h4 class="modal-title">Error</h4>
		}
		<button
			type="button"
			class="btn-close"
			style="cursor: pointer"
			(click)="bsModalRef.hide()"
			aria-label="Close"
		></button>
	</div>
	<div class="modal-body">
		@if (extensionStatus === 0) {
			<div class="alert alert-primary" role="alert">
				Waiting...
				<i class="fa fa-spinner fa-spin" style="font-size: 24px"> </i>
			</div>
		}
		@if (extensionStatus === 1) {
			<div id="extension_result_submitted" class="alert alert-success" role="alert">
				@if (modificationExtension) {
					<div data-test-id="modification_request_result_div">Modification request successfully submitted!</div>
				}
				@if (lifetimeExtension) {
					<div data-test-id="extension_request_result_div">Lifetime extension request successfully submitted!</div>
				}
				@if (creditsExtension) {
					<div data-test-id="credit_request_result_div">Credits extension request successfully submitted!</div>
				}
			</div>
		}
		@if (extensionStatus === 5) {
			<div id="adjustment_result_submitted" class="alert alert-success" role="alert">
				<div data-test-id="modification_adjustment_request_result_div">
					Modification adjustment successfully submitted!
				</div>
			</div>
		}
		@if (extensionStatus === 2) {
			<div id="extension_result_error" class="alert alert-warning" role="alert">
				An error occured:<br />
				{{ errorMessage }}
			</div>
		}
		<div class="modal-footer">
			<button type="button" class="btn btn-secondary" (click)="bsModalRef.hide()">Close</button>
		</div>
	</div>
	<!-- /.modal-content -->
}
